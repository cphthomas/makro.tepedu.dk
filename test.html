<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Chart with Data Labels</title>
    
    <!-- 1. Import the Chart.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    
    <!-- 2. Import the Datalabels Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0"></script>

    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f2f5;
            font-family: sans-serif;
        }
        .chart-container {
            width: 80vw;
            max-width: 900px;
            height: 70vh;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

    <div class="chart-container">
        <canvas id="plot7"></canvas>
    </div>

    <script>
        window.onload = function() {
            const ctx = document.getElementById('plot7').getContext('2d');

            const myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: 'Efterspørgsel',
                        data: [
                            {x: 0, y: 100}, {x: 20, y: 90}, {x: 40, y: 80}, {x: 60, y: 70}, {x: 80, y: 60},
                            {x: 100, y: 50}, {x: 120, y: 40}, {x: 140, y: 30}, {x: 160, y: 20}, {x: 180, y: 10}, {x: 200, y: 0}
                        ],
                        borderColor: 'green', backgroundColor: 'transparent', borderWidth: 2.5, pointRadius: 3, pointBackgroundColor: 'green', lineTension: 0
                    },
                    {
                        label: 'Udbud',
                        data: [
                            {x: 0, y: 20}, {x: 20, y: 30}, {x: 40, y: 40}, {x: 60, y: 50}, {x: 80, y: 60},
                            {x: 100, y: 70}, {x: 120, y: 80}, {x: 140, y: 90}, {x: 160, y: 100}, {x: 180, y: 110}, {x: 200, y: 120}
                        ],
                        borderColor: 'red', backgroundColor: 'transparent', borderWidth: 2.5, pointRadius: 3, pointBackgroundColor: 'red', lineTension: 0
                    },
                    {
                        label: 'Prislinje (P=80)',
                        data: [ { x: 0, y: 80 }, { x: 40, y: 80 }, { x: 40, y: 0 } ],
                        borderColor: 'black', borderWidth: 1, borderDash: [5, 5], fill: false, pointRadius: 0, lineTension: 0
                    },
                    {
                        label: 'Forbrugeroverskud',
                        data: [ { x: 0, y: 100 }, { x: 40, y: 80 }, { x: 0, y: 80 } ],
                        backgroundColor: 'rgba(75, 192, 192, 0.7)', borderColor: 'transparent', fill: true, pointRadius: 0, lineTension: 0
                    },
                    {
                        label: 'Producentoverskud',
                        data: [ { x: 0, y: 80 }, { x: 40, y: 80 }, { x: 40, y: 40 }, { x: 0, y: 20 } ],
                        backgroundColor: 'rgba(153, 102, 255, 0.5)', borderColor: 'transparent', fill: true, pointRadius: 0, lineTension: 0
                    },
                    {
                        label: 'DWL',
                        data: [ { x: 40, y: 80 }, { x: 40, y: 40 }, { x: 80, y: 60 } ],
                        backgroundColor: 'rgba(128, 128, 128, 0.5)', borderColor: 'transparent', fill: true, pointRadius: 0, lineTension: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    title: {
                        display: true,
                        text: 'Forbrugeroverskud og Producentoverskud (Pris = 80)',
                        fontSize: 18
                    },
                    scales: {
                        xAxes: [{
                            type: 'linear',
                            position: 'bottom',
                            scaleLabel: { display: true, labelString: 'Efterspørgsel i stk.' },
                            ticks: { beginAtZero: true, stepSize: 20 }
                        }],
                        yAxes: [{
                            scaleLabel: { display: true, labelString: 'Pris (kr.)' },
                            ticks: { beginAtZero: true, stepSize: 10 }
                        }]
                    },
                    // 3. ADDED THIS SECTION TO CONFIGURE THE LABELS
                    plugins: {
                        datalabels: {
                            // This function controls how the label is formatted
                            formatter: function(value, context) {
                                const point = context.dataset.data[context.dataIndex];
                                return '(' + point.x + ', ' + point.y + ')';
                            },
                            // This function controls which labels are shown
                            display: function(context) {
                                const datasetLabel = context.dataset.label;
                                // Only show labels for these two datasets
                                return datasetLabel === 'Efterspørgsel' || datasetLabel === 'Udbud';
                            },
                            color: '#333',
                            font: {
                                weight: 'bold',
                                size: 10,
                            },
                            align: 'end', // Position the label above the point
                            offset: 8     // Distance in pixels from the point
                        }
                    }
                }
            });
        };
    </script>

</body>
</html>